<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEART-52</title>
    <style>
        /* Reset and base styles */
        .logo {
             display: block;
             margin: 0 auto 1rem;
             width: 100px;
             max-width: 100%;
             height: auto;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #1E3A8A;
            background: linear-gradient(135deg, #3B82F6 0%, #10B981 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            opacity: 0.95;
        }

        /* Quick Jump Navigation */
        .quick-jump {
            margin-top: 25px;
            text-align: center;
        }

        .jump-instruction {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            font-weight: 400;
        }

        .jump-buttons {
            display: flex;
            justify-content: center;
            gap: 3px;
            flex-wrap: wrap;
        }

        .jump-btn {
            padding: 6px 12px;
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.60rem;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            min-width: 60px;
        }

        .jump-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.9);
            transform: translateY(-1px);
        }

        /* Highlight animation for jumped-to verse */
        .verse-highlight {
            animation: highlightGlow 2s ease-out;
        }

        @keyframes highlightGlow {
            0% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
                border-color: #3B82F6;
                transform: scale(1.02);
            }
            50% {
                box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
            }
            100% {
                box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2);
                border-color: transparent;
                transform: scale(1);
            }
        }
        .nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.9);
            color: #059669;
            border: 2px solid #6EE7B7;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: #6EE7B7;
            color: #065F46;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #6EE7B7;
            color: #065F46;
            box-shadow: 0 4px 15px rgba(110, 231, 183, 0.3);
        }

        /* Main content area */
        .content {
            background: #FFFFFF;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        /* Home page styles */
        .verse-list {
            display: grid;
            gap: 15px;
        }

        .verse-item {
            background: linear-gradient(135deg, #E0F2FE 0%, #D1FAE5 100%);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .verse-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2);
            border-color: #3B82F6;
        }

        .verse-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3B82F6;
            margin-bottom: 5px;
            font-family: Arial, sans-serif;
        }

        .verse-reference {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1E3A8A;
            margin-bottom: 8px;
            font-family: Arial, sans-serif;
        }

        .verse-theme {
            font-size: 0.9rem;
            font-weight: 500;
            color: #059669;
            margin-bottom: 8px;
            font-family: Arial, sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .verse-preview {
            color: #1E3A8A;
            opacity: 0.7;
            font-style: italic;
            font-family: Arial, sans-serif;
        }

        /* Week indicator */
        .week-indicator {
            text-align: center;
            margin-bottom: 20px;
            padding: 8px 16px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            display: inline-block;
            margin: 0 auto 20px auto;
        }

        /* Verse page styles */
        .verse-page {
            text-align: center;
        }

        .verse-display {
            background: linear-gradient(135deg, #E0F2FE 0%, #D1FAE5 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .verse-theme-display {
            font-size: 1rem;
            font-weight: 600;
            color: #059669;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: Arial, sans-serif;
        }

        .verse-text {
            font-size: 1.3rem;
            line-height: 1.8;
            margin-bottom: 20px;
            color: #1E3A8A;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        .verse-ref {
            font-size: 1.1rem;
            font-weight: bold;
            color: #3B82F6;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        /* Memory training display - match the verse display exactly */
        .memory-display {
            background: linear-gradient(135deg, #E0F2FE 0%, #D1FAE5 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .memory-text {
            font-size: 1.3rem;
            line-height: 1.8;
            margin-bottom: 20px;
            color: #1E3A8A;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        .memory-ref {
            font-size: 1.1rem;
            font-weight: bold;
            color: #3B82F6;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        /* Audio controls */
        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .audio-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #3B82F6 0%, #1E3A8A 100%);
            color: #FFFFFF;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }

        .audio-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .audio-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .audio-btn.active {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Speed controls */
        .speed-controls {
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .speed-heading {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .speed-control-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .speed-label {
            color: #34495e;
            font-weight: 500;
        }

        /* Memory training instruction */
        .memory-instruction {
            text-align: center;
            margin: 20px 0 15px 0;
            font-size: 1rem;
            font-weight: 400;
            color: #1E3A8A;
            line-height: 1.4;
        }

        /* Memory training controls */
        .training-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 8px 16px;
            background: #E0F2FE;
            color: #3B82F6;
            border: 2px solid #3B82F6;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .level-btn:hover {
            background: #3B82F6;
            color: #FFFFFF;
        }

        .level-btn.active {
            background: #10B981;
            color: #FFFFFF;
            border-color: #10B981;
        }

        .blank {
            background: #E0F2FE;
            color: #E0F2FE;
            padding: 2px 8px;
            border-radius: 4px;
            margin: 0 2px;
            border: 2px dashed #3B82F6;
            user-select: none;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .content {
                padding: 20px;
            }

            .verse-text {
                font-size: 1.1rem;
            }

            .audio-controls {
                flex-direction: column;
                align-items: center;
            }

            .audio-btn {
                width: 100%;
                max-width: 200px;
            }

            .nav {
                justify-content: center;
            }

            .training-controls {
                flex-direction: column;
                align-items: center;
            }

            .level-btn {
                width: 100%;
                max-width: 150px;
            }

            .jump-buttons {
                gap: 8px;
            }

            .jump-btn {
                font-size: 0.8rem;
                padding: 7px 14px;
                min-width: 70px;
            }

            .memory-instruction {
                font-size: 0.9rem;
                margin: 15px 0 12px 0;
                padding: 0 10px;
            }
        }

        /* Hidden class for view switching */
        .hidden {
            display: none !important;
        }

        /* Loading animation */
        .loading {
            text-align: center;
            color: #667eea;
            font-size: 1.1rem;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: '....'; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
           <img
  src="https://raw.githubusercontent.com/davepartin/bible-memory/main/heart52logo.svg"
  alt="Heart-52 Logo"
  class="logo"
/>

            <p>52 Verses. 52 Weeks.<br> 
                God's Word in Your Heart.</p>
            
            <!-- Quick Jump Navigation -->
            <div class="quick-jump" id="quick-jump">
                <div class="jump-instruction">Scroll down to</div>
                <div class="jump-buttons">
                    <button class="jump-btn" onclick="jumpToWeek(10)">Week 10</button>
                    <button class="jump-btn" onclick="jumpToWeek(20)">Week 20</button>
                    <button class="jump-btn" onclick="jumpToWeek(30)">Week 30</button>
                    <button class="jump-btn" onclick="jumpToWeek(40)">Week 40</button>
                </div>
            </div>
        </header>

        <nav class="nav">
            <button class="nav-btn active" onclick="showHome()">Home</button>
        </nav>

        <main class="content">
            <!-- Home View -->
            <div id="home-view">
                <div class="verse-list" id="verse-list">
                    <!-- Verse items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Verse View -->
            <div id="verse-view" class="hidden">
                <div class="verse-page">
                    <div class="week-indicator-simple" id="current-week-indicator">
                        <!-- Week indicator will be populated by JavaScript -->
                    </div>
                    
                    <div class="verse-display">
                        <div class="verse-theme-display" id="current-verse-theme"></div>
                        <div class="verse-text" id="current-verse-text"></div>
                        <div class="verse-ref" id="current-verse-ref"></div>
                    </div>

                    <div class="audio-controls">
                        <button class="audio-btn" id="play-once-btn" onclick="playOnce()">
                            üîä Play Once
                        </button>
                        <button class="audio-btn" id="stop-btn" onclick="stopAudio()">
                            ‚èπÔ∏è Stop
                        </button>
                        <button class="audio-btn" id="loop-btn" onclick="toggleLoop()">
                            üîÅ Loop
                        </button>
                    </div>

                    <div class="speed-controls" id="speed-controls">
                        <!-- Speed control will be added by JavaScript -->
                    </div>

                    <div class="memory-instruction">
                        Test your memory by hiding words.<br>
                        Choose your difficulty:
                    </div>

                    <div class="training-controls">
                        <button class="level-btn" onclick="setMemoryLevel(0)">Full Text</button>
                        <button class="level-btn active" onclick="setMemoryLevel(1)">Level 1 (10%)</button>
                        <button class="level-btn" onclick="setMemoryLevel(2)">Level 2 (25%)</button>
                        <button class="level-btn" onclick="setMemoryLevel(3)">Level 3 (50%)</button>
                    </div>

                    <div class="memory-display">
                        <div class="memory-text" id="memory-text"></div>
                        <div class="memory-ref" id="memory-ref"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let lastScrollY = 0;
        // HEART-52 Complete Collection with updated verses from Google Sheet
        const verses = [
            {
                reference: "Psalm 119:11",
                theme: "God's Word",
                text: "I have stored up your word in my heart, that I might not sin against you."
            },
            {
                reference: "John 3:16",
                theme: "The Gospel",
                text: "For God so loved the world, that he gave his only Son, that whoever believes in him should not perish but have eternal life."
            },
            {
                reference: "Romans 3:23",
                theme: "Admit Sin",
                text: "for all have sinned and fall short of the glory of God,"
            },
            {
                reference: "Romans 6:23",
                theme: "Admit Sin",
                text: "For the wages of sin is death, but the free gift of God is eternal life in Christ Jesus our Lord."
            },
            {
                reference: "Romans 5:8",
                theme: "Believe in Jesus as Savior",
                text: "but God shows his love for us in that while we were still sinners, Christ died for us."
            },
            {
                reference: "Romans 10:9",
                theme: "Confess Jesus as Lord",
                text: "because, if you confess with your mouth that Jesus is Lord and believe in your heart that God raised him from the dead, you will be saved."
            },
            {
                reference: "Colossians 2:6-7",
                theme: "Discipleship",
                text: "Therefore, as you received Christ Jesus the Lord, so walk in him, rooted and built up in him and established in the faith, just as you were taught, abounding in thanksgiving."
            },
            {
                reference: "Matthew 28:19-20",
                theme: "Evangelism",
                text: "Go therefore and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit, teaching them to observe all that I have commanded you. And behold, I am with you always, to the end of the age."
            },
            {
                reference: "Romans 15:7",
                theme: "Family of God",
                text: "Therefore welcome one another as Christ has welcomed you, for the glory of God."
            },
            {
                reference: "2 Corinthians 5:17",
                theme: "Identity in Christ",
                text: "Therefore, if anyone is in Christ, he is a new creation. The old has passed away; behold, the new has come."
            },
            {
                reference: "John 1:12",
                theme: "Identity in Christ",
                text: "But to all who did receive him, who believed in his name, he gave the right to become children of God,"
            },
            {
                reference: "Romans 8:1",
                theme: "Identity in Christ",
                text: "There is therefore now no condemnation for those who are in Christ Jesus."
            },
            {
                reference: "Matthew 6:9-13",
                theme: "Prayer",
                text: "Pray then like this: Our Father in heaven, hallowed be your name. Your kingdom come, your will be done, on earth as it is in heaven. Give us this day our daily bread, and forgive us our debts, as we also have forgiven our debtors. And lead us not into temptation, but deliver us from evil."
            },
            {
                reference: "Ephesians 2:8-9",
                theme: "Salvation",
                text: "For by grace you have been saved through faith. And this is not your own doing; it is the gift of God, not a result of works, so that no one may boast."
            },
            {
                reference: "Romans 8:28",
                theme: "Trust in God",
                text: "And we know that for those who love God all things work together for good, for those who are called according to his purpose."
            },
            {
                reference: "Romans 12:1-2",
                theme: "Living Sacrifice",
                text: "I appeal to you therefore, brothers, by the mercies of God, to present your bodies as a living sacrifice, holy and acceptable to God, which is your spiritual worship. Do not be conformed to this world, but be transformed by the renewal of your mind, that by testing you may discern what is the will of God, what is good and acceptable and perfect."
            },
            {
                reference: "Galatians 2:20",
                theme: "Identity in Christ",
                text: "I have been crucified with Christ. It is no longer I who live, but Christ who lives in me. And the life I now live in the flesh I live by faith in the Son of God, who loved me and gave himself for me."
            },
            {
                reference: "1 Corinthians 6:19-20",
                theme: "Holiness",
                text: "Or do you not know that your body is a temple of the Holy Spirit within you, whom you have from God? You are not your own, for you were bought with a price. So glorify God in your body."
            },
            {
                reference: "2 Timothy 3:16-17",
                theme: "God's Word",
                text: "All Scripture is breathed out by God and profitable for teaching, for reproof, for correction, and for training in righteousness, that the man of God may be complete, equipped for every good work."
            },
            {
                reference: "Hebrews 4:12",
                theme: "God's Word",
                text: "For the word of God is living and active, sharper than any two-edged sword, piercing to the division of soul and of spirit, of joints and of marrow, and discerning the thoughts and intentions of the heart."
            },
            {
                reference: "Matthew 22:37-39",
                theme: "Love God and Others",
                text: "And he said to him, 'You shall love the Lord your God with all your heart and with all your soul and with all your mind. This is the great and first commandment. And a second is like it: You shall love your neighbor as yourself.'"
            },
            {
                reference: "John 14:6",
                theme: "Salvation",
                text: "Jesus said to him, 'I am the way, and the truth, and the life. No one comes to the Father except through me.'"
            },
            {
                reference: "John 15:5",
                theme: "Identity in Christ",
                text: "I am the vine; you are the branches. Whoever abides in me and I in him, he it is that bears much fruit, for apart from me you can do nothing."
            },
            {
                reference: "1 John 1:9",
                theme: "Forgiveness",
                text: "If we confess our sins, he is faithful and just to forgive us our sins and to cleanse us from all unrighteousness."
            },
            {
                reference: "Proverbs 3:5-6",
                theme: "Trust in God",
                text: "Trust in the Lord with all your heart, and do not lean on your own understanding. In all your ways acknowledge him, and he will make straight your paths."
            },
            {
                reference: "Philippians 4:6-7",
                theme: "Prayer & Peace",
                text: "do not be anxious about anything, but in everything by prayer and supplication with thanksgiving let your requests be made known to God. And the peace of God, which surpasses all understanding, will guard your hearts and your minds in Christ Jesus."
            },
            {
                reference: "Philippians 4:13",
                theme: "Strength in Christ",
                text: "I can do all things through him who strengthens me."
            },
            {
                reference: "Philippians 1:6",
                theme: "Growth in Christ",
                text: "And I am sure of this, that he who began a good work in you will bring it to completion at the day of Jesus Christ."
            },
            {
                reference: "Philippians 2:3-5",
                theme: "Humility",
                text: "Do nothing from selfish ambition or conceit, but in humility count others more significant than yourselves. Let each of you look not only to his own interests, but also to the interests of others. Have this mind among yourselves, which is yours in Christ Jesus,"
            },
            {
                reference: "Galatians 5:22-23",
                theme: "Character",
                text: "But the fruit of the Spirit is love, joy, peace, patience, kindness, goodness, faithfulness, gentleness, self-control; against such things there is no law."
            },
            {
                reference: "Colossians 3:23",
                theme: "Work for the Lord",
                text: "Whatever you do, work heartily, as for the Lord and not for men,"
            },
            {
                reference: "Ephesians 4:29",
                theme: "Speech",
                text: "Let no corrupting talk come out of your mouths, but only such as is good for building up, as fits the occasion, that it may give grace to those who hear."
            },
            {
                reference: "Ephesians 4:32",
                theme: "Kindness & Forgiveness",
                text: "Be kind to one another, tenderhearted, forgiving one another, as God in Christ forgave you."
            },
            {
                reference: "Ephesians 6:1-3",
                theme: "Family",
                text: "Children, obey your parents in the Lord, for this is right. 'Honor your father and mother' (this is the first commandment with a promise), 'that it may go well with you and that you may live long in the land.'"
            },
            {
                reference: "1 Thessalonians 5:16-18",
                theme: "Joy & Prayer",
                text: "Rejoice always, pray without ceasing, give thanks in all circumstances; for this is the will of God in Christ Jesus for you."
            },
            {
                reference: "Matthew 6:33",
                theme: "Seek the Kingdom",
                text: "But seek first the kingdom of God and his righteousness, and all these things will be added to you."
            },
            {
                reference: "Matthew 5:16",
                theme: "Witness",
                text: "In the same way, let your light shine before others, so that they may see your good works and give glory to your Father who is in heaven."
            },
            {
                reference: "Psalm 23:4",
                theme: "God's Care",
                text: "Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me."
            },
            {
                reference: "Joshua 1:9",
                theme: "Courage",
                text: "Have I not commanded you? Be strong and courageous. Do not be frightened, and do not be dismayed, for the Lord your God is with you wherever you go."
            },
            {
                reference: "James 1:22",
                theme: "Obedience",
                text: "But be doers of the word, and not hearers only, deceiving yourselves."
            },
            {
                reference: "Matthew 7:7",
                theme: "Prayer",
                text: "Ask, and it will be given to you; seek, and you will find; knock, and it will be opened to you."
            },
            {
                reference: "John 10:10",
                theme: "Abundant Life",
                text: "The thief comes only to steal and kill and destroy. I came that they may have life and have it abundantly."
            },
            {
                reference: "Micah 6:8",
                theme: "Justice & Mercy",
                text: "He has told you, O man, what is good; and what does the Lord require of you but to do justice, and to love kindness, and to walk humbly with your God?"
            },
            {
                reference: "Hebrews 11:1",
                theme: "Faith",
                text: "Now faith is the assurance of things hoped for, the conviction of things not seen."
            },
            {
                reference: "Psalm 37:4",
                theme: "Desire God",
                text: "Delight yourself in the Lord, and he will give you the desires of your heart."
            },
            {
                reference: "Philippians 3:8",
                theme: "Treasure Christ",
                text: "Indeed, I count everything as loss because of the surpassing worth of knowing Christ Jesus my Lord. For his sake I have suffered the loss of all things and count them as rubbish, in order that I may gain Christ"
            },
            {
                reference: "Matthew 6:34",
                theme: "Trust in God",
                text: "Therefore do not be anxious about tomorrow, for tomorrow will be anxious for itself. Sufficient for the day is its own trouble."
            },
            {
                reference: "James 4:17",
                theme: "Obedience",
                text: "So whoever knows the right thing to do and fails to do it, for him it is sin."
            },
            {
                reference: "Matthew 7:12",
                theme: "Golden Rule",
                text: "Therefore, whatever you want men to do to you, do also to them, for this is the Law and the Prophets."
            },
            {
                reference: "Genesis 1:1",
                theme: "Creator God",
                text: "In the beginning, God created the heavens and the earth."
            },
            {
                reference: "2 Peter 1:3",
                theme: "God's Provision",
                text: "His divine power has granted to us all things that pertain to life and godliness, through the knowledge of him who called us to his own glory and excellence,"
            },
            {
                reference: "Revelation 3:20",
                theme: "Invitation",
                text: "Behold, I stand at the door and knock. If anyone hears my voice and opens the door, I will come in to him and eat with him, and he with me."
            }
        ];

        // Global variables
        let currentVerse = null;
        let currentMemoryLevel = 1;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let isLooping = false;
        let speechRate = 1.0;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            populateVerseList();
            showHome();
            addAudioControls();
            
            // Initialize voices when they're available
            if (speechSynthesis.getVoices().length === 0) {
                speechSynthesis.addEventListener('voiceschanged', () => {
                    console.log('Voices loaded');
                });
            }
        }

        // Populate the home page verse list
        function populateVerseList() {
            const verseList = document.getElementById('verse-list');
            verseList.innerHTML = '';

            verses.forEach((verse, index) => {
                const verseItem = document.createElement('div');
                verseItem.className = 'verse-item';
                verseItem.onclick = () => showVerse(index);

                // Create 5-word hint instead of 3-word
                const firstFiveWords = verse.text.split(' ').slice(0, 5).join(' ') + '...';

                verseItem.innerHTML = `
                    <div class="verse-number">Week ${index + 1}</div>
                    <div class="verse-reference">${verse.reference}</div>
                    <div class="verse-theme">${verse.theme}</div>
                    <div class="verse-preview">${firstFiveWords}</div>
                `;

                verseList.appendChild(verseItem);
            });
        }

        // Navigation functions
        function showHome() {
    document.getElementById('home-view').classList.remove('hidden');
    document.getElementById('verse-view').classList.add('hidden');
    
    // Show the quick-jump navigation on home page
    document.getElementById('quick-jump').classList.remove('hidden');
    
    updateNavigation('home');
    stopAudio();

    window.scrollTo(0, lastScrollY);
        }

        function showVerse(index) {
    lastScrollY = window.scrollY;

    currentVerse = verses[index];
    document.getElementById('home-view').classList.add('hidden');
    document.getElementById('verse-view').classList.remove('hidden');
    
    // Hide the quick-jump navigation on verse pages
    document.getElementById('quick-jump').classList.add('hidden');
    
    updateNavigation('verse');
    displayVerse();
    updateMemoryText();

    window.scrollTo(0, 0);
        }

        // Quick jump functionality
        function jumpToWeek(weekNumber) {
            const targetIndex = weekNumber - 1; // Convert to 0-based index
            const verseItems = document.querySelectorAll('.verse-item');
            
            if (verseItems[targetIndex]) {
                // Smooth scroll to the target verse
                verseItems[targetIndex].scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
                
                // Add highlight animation
                verseItems[targetIndex].classList.add('verse-highlight');
                
                // Remove highlight class after animation completes
                setTimeout(() => {
                    verseItems[targetIndex].classList.remove('verse-highlight');
                }, 2000);
            }
        }

        function updateNavigation(activeView) {
            const navButtons = document.querySelectorAll('.nav-btn');
            navButtons.forEach(btn => btn.classList.remove('active'));

            if (activeView === 'home') {
                navButtons[0].classList.add('active');
            }
        }

        // Display current verse
        function displayVerse() {
            if (!currentVerse) return;

            document.getElementById('current-verse-theme').textContent = currentVerse.theme;
            document.getElementById('current-verse-text').textContent = currentVerse.text;
            document.getElementById('current-verse-ref').textContent = currentVerse.reference;
            
            // Update week indicator
            const weekIndicator = document.getElementById('current-week-indicator');
            const weekNumber = verses.indexOf(currentVerse) + 1;
            weekIndicator.textContent = `Week ${weekNumber}`;
            
            // Apply styling directly via JavaScript
            weekIndicator.style.fontSize = '1.5rem';
            weekIndicator.style.fontWeight = 'bold';
            weekIndicator.style.color = '#93C5FD';
            weekIndicator.style.opacity = '0.8';
            weekIndicator.style.fontFamily = 'Arial, sans-serif';
            weekIndicator.style.textAlign = 'center';
            weekIndicator.style.marginBottom = '20px';
            weekIndicator.style.background = 'none';
            weekIndicator.style.border = 'none';
            weekIndicator.style.padding = '0';
        }

        // Audio functions
        function playOnce() {
            if (!currentVerse) return;

            stopAudio();
            
            let voices = speechSynthesis.getVoices();
            if (voices.length === 0) {
                speechSynthesis.addEventListener('voiceschanged', () => {
                    voices = speechSynthesis.getVoices();
                    playOnceWithVoices(voices);
                });
                return;
            }
            
            playOnceWithVoices(voices);
        }

        function playOnceWithVoices(voices) {
            console.log('All available voices:');
            voices.forEach((voice, index) => {
                console.log(`${index}: ${voice.name} (${voice.lang})`);
            });
            
            let selectedVoice = null;
            
            const hasGoogleVoices = voices.some(voice => voice.name.includes('Google'));
            const hasMobileVoices = voices.some(voice => 
                voice.name.includes('Samantha') || 
                voice.name.includes('Alex') || 
                voice.name.includes('Fred') ||
                voice.name.includes('Daniel')
            );
            
            if (hasMobileVoices) {
                console.log('üì± Mobile device detected - using mobile voices');
                
                const mobileVoices = [
                    'Daniel (en-GB)',
                    'Daniel (Enhanced)',
                    'Daniel',
                    'Oliver (en-GB)',
                    'Oliver',
                    'Alex',
                    'Tom'
                ];
                
                for (const voiceName of mobileVoices) {
                    selectedVoice = voices.find(voice => 
                        voice.name === voiceName || 
                        voice.name.includes(voiceName) ||
                        (voice.name.includes('Daniel') && voice.name.includes('en-GB'))
                    );
                    if (selectedVoice) {
                        console.log('‚úÖ Found mobile voice:', selectedVoice.name);
                        break;
                    }
                }
            } else {
                console.log('üñ•Ô∏è Desktop device detected - using Google voices');
                
                const desktopVoices = [
                    'Google UK English Male',
                    'Google US English',
                    'Microsoft David - English (United States)'
                ];
                
                for (const voiceName of desktopVoices) {
                    selectedVoice = voices.find(voice => voice.name === voiceName);
                    if (selectedVoice) {
                        console.log('‚úÖ Found desktop voice:', selectedVoice.name);
                        break;
                    }
                }
            }
            
            if (!selectedVoice) {
                console.log('‚ö†Ô∏è No preferred voices found, looking for alternatives...');
                
                const avoidVoices = ['Karen', 'Princess', 'Bad News', 'Bells', 'Boing'];
                
                selectedVoice = voices.find(voice => 
                    voice.lang.startsWith('en') && 
                    !avoidVoices.some(badVoice => voice.name.includes(badVoice))
                );
                
                console.log('üîÑ Using fallback voice:', selectedVoice?.name || 'Default');
            }
            
            const fullText = formatTextForSpeech(currentVerse.text) + '. ' + currentVerse.reference + '.';
            currentUtterance = new SpeechSynthesisUtterance(fullText);
            
            if (selectedVoice) {
                currentUtterance.voice = selectedVoice;
                console.log('üéµ Play Once using voice:', selectedVoice.name);
            }
            
            currentUtterance.rate = speechRate;
            currentUtterance.pitch = 1.0;
            currentUtterance.volume = 1;

            updateAudioButtons('playing');
            
            currentUtterance.onend = () => {
                updateAudioButtons('stopped');
            };
            
            currentUtterance.onerror = (event) => {
                console.log('Speech error:', event.error);
                updateAudioButtons('stopped');
            };

            speechSynthesis.speak(currentUtterance);
        }

        function playLoop() {
            if (!isLooping || !currentVerse) return;

            const voices = speechSynthesis.getVoices();
            let selectedVoice = null;
            
            const hasMobileVoices = voices.some(voice => 
                voice.name.includes('Samantha') || 
                voice.name.includes('Alex') || 
                voice.name.includes('Fred') ||
                voice.name.includes('Daniel')
            );
            
            if (hasMobileVoices) {
                const mobileVoices = [
                    'Daniel (en-GB)',
                    'Daniel (Enhanced)',
                    'Daniel',
                    'Oliver (en-GB)',
                    'Oliver',
                    'Alex',
                    'Tom',
                    'Siri Voice 5 (Enhanced)'
                ];
                
                for (const voiceName of mobileVoices) {
                    selectedVoice = voices.find(voice => 
                        voice.name === voiceName || 
                        voice.name.includes(voiceName) ||
                        (voice.name.includes('Daniel') && voice.name.includes('en-GB'))
                    );
                    if (selectedVoice) {
                        console.log('üîÅ Loop using mobile voice:', selectedVoice.name);
                        break;
                    }
                }
            } else {
                const desktopVoices = [
                    'Google UK English Male',
                    'Google US English',
                    'Microsoft David - English (United States)'
                ];
                
                for (const voiceName of desktopVoices) {
                    selectedVoice = voices.find(voice => voice.name === voiceName);
                    if (selectedVoice) {
                        console.log('üîÅ Loop using desktop voice:', selectedVoice.name);
                        break;
                    }
                }
            }
            
            if (!selectedVoice) {
                const avoidVoices = ['Karen', 'Princess', 'Bad News', 'Bells', 'Boing'];
                selectedVoice = voices.find(voice => 
                    voice.lang.startsWith('en') && 
                    !avoidVoices.some(badVoice => voice.name.includes(badVoice))
                );
                console.log('üîÅ Loop using fallback voice:', selectedVoice?.name || 'Default');
            }
            
            const fullText = formatTextForSpeech(currentVerse.text) + '. ' + currentVerse.reference + '.';
            currentUtterance = new SpeechSynthesisUtterance(fullText);
            
            if (selectedVoice) {
                currentUtterance.voice = selectedVoice;
            }
            
            currentUtterance.rate = speechRate;
            currentUtterance.pitch = 1.0;
            currentUtterance.volume = 1;

            currentUtterance.onend = () => {
                if (isLooping) {
                    setTimeout(() => {
                        if (isLooping) playLoop();
                    }, 1000);
                }
            };
            
            currentUtterance.onerror = (event) => {
                console.log('Speech synthesis loop error:', event.error);
                if (isLooping) {
                    setTimeout(() => {
                        if (isLooping) playLoop();
                    }, 1000);
                }
            };

            speechSynthesis.speak(currentUtterance);
        }

        function toggleLoop() {
            if (isLooping) {
                stopAudio();
            } else {
                startLoop();
            }
        }

        function startLoop() {
            if (!currentVerse) return;

            isLooping = true;
            updateAudioButtons('looping');
            playLoop();
        }

        function stopAudio() {
            speechSynthesis.cancel();
            isLooping = false;
            currentUtterance = null;
            updateAudioButtons('stopped');
        }

        function updateAudioButtons(state) {
            const playBtn = document.getElementById('play-once-btn');
            const loopBtn = document.getElementById('loop-btn');
            const stopBtn = document.getElementById('stop-btn');

            playBtn.classList.remove('active');
            loopBtn.classList.remove('active');
            playBtn.disabled = false;
            loopBtn.disabled = false;
            stopBtn.disabled = false;

            switch(state) {
                case 'playing':
                    playBtn.classList.add('active');
                    playBtn.disabled = true;
                    break;
                case 'looping':
                    loopBtn.classList.add('active');
                    loopBtn.textContent = '‚è∏Ô∏è Stop Loop';
                    playBtn.disabled = true;
                    break;
                case 'stopped':
                    loopBtn.textContent = 'üîÅ Loop';
                    break;
            }
        }

        // Memory training functions
        function setMemoryLevel(level) {
            currentMemoryLevel = level;
            updateMemoryLevelButtons();
            updateMemoryText();
        }

        function updateMemoryLevelButtons() {
            const levelButtons = document.querySelectorAll('.level-btn');
            levelButtons.forEach((btn, index) => {
                btn.classList.toggle('active', index === currentMemoryLevel);
            });
        }

        function updateMemoryText() {
            if (!currentVerse) return;

            const memoryTextElement = document.getElementById('memory-text');
            const memoryRefElement = document.getElementById('memory-ref');
            let displayText = currentVerse.text;

            if (currentMemoryLevel > 0) {
                displayText = createMemoryText(currentVerse.text, currentMemoryLevel);
            }

            memoryTextElement.innerHTML = displayText;
            // Add the verse reference to the memory training section
            memoryRefElement.textContent = currentVerse.reference;
        }

        function createMemoryText(text, level) {
            const words = text.split(' ');
            let removalPercentage;

            switch(level) {
                case 1: removalPercentage = 0.1; break;  // 10%
                case 2: removalPercentage = 0.25; break; // 25%
                case 3: removalPercentage = 0.5; break;  // 50%
                default: return text;
            }

            const wordsToRemove = Math.floor(words.length * removalPercentage);
            const indicesToRemove = new Set();

            while (indicesToRemove.size < wordsToRemove) {
                const randomIndex = Math.floor(Math.random() * words.length);
                indicesToRemove.add(randomIndex);
            }

            return words.map((word, index) => {
                if (indicesToRemove.has(index)) {
                    return `<span class="blank">${'_'.repeat(Math.max(3, word.length))}</span>`;
                }
                return word;
            }).join(' ');
        }

        // Format text for better speech synthesis
        function formatTextForSpeech(text) {
            return text
                .replace(/,/g, ', ')
                .replace(/;/g, '; ')
                .replace(/\./g, '. ')
                .replace(/\bvs?\.\s/gi, 'verse ')
                .replace(/\bch\.\s/gi, 'chapter ')
                .replace(/\bPs\.\s/gi, 'Psalm ')
                .replace(/\bMt\.\s/gi, 'Matthew ')
                .replace(/\bMk\.\s/gi, 'Mark ')
                .replace(/\bLk\.\s/gi, 'Luke ')
                .replace(/\bJn\.\s/gi, 'John ')
                .replace(/(\d+):(\d+)/g, '$1 verse $2');
        }

        // Add audio controls for speed adjustment
        function addAudioControls() {
            const speedControls = document.getElementById('speed-controls');
            
            speedControls.innerHTML = `
                <div class="speed-control-row">
                    <label for="speed-slider" class="speed-label">Speed:</label>
                    <input type="range" id="speed-slider" min="0.5" max="1.5" step="0.1" value="1.0" 
                           onchange="updateSpeechSpeed(this.value)">
                    <span id="speed-display" class="speed-display">1.0x</span>
                </div>
            `;
        }

        function updateSpeechSpeed(rate) {
            speechRate = parseFloat(rate);
            document.getElementById('speed-display').textContent = rate + 'x';
        }

        // Handle browser back button
        window.addEventListener('popstate', function(event) {
            if (event.state && event.state.view === 'verse') {
                // Handle back to verse view if needed
            } else {
                showHome();
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (document.getElementById('verse-view').classList.contains('hidden')) return;

            switch(event.key) {
                case ' ':
                    event.preventDefault();
                    playOnce();
                    break;
                case 'l':
                    event.preventDefault();
                    toggleLoop();
                    break;
                case 's':
                    event.preventDefault();
                    stopAudio();
                    break;
                case '1':
                    event.preventDefault();
                    setMemoryLevel(1);
                    break;
                case '2':
                    event.preventDefault();
                    setMemoryLevel(2);
                    break;
                case '3':
                    event.preventDefault();
                    setMemoryLevel(3);
                    break;
                case '0':
                    event.preventDefault();
                    setMemoryLevel(0);
                    break;
                case 'Escape':
                    showHome();
                    break;
            }
        });
    </script>
</body>
</html>
